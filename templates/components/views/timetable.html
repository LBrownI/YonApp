<!DOCTYPE html>
<section id="tab-timetable" class="view-section hidden space-y-6">
    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 flex flex-wrap gap-4 items-center justify-between">
        <div class="flex gap-4 items-center">
            <label class="text-sm font-medium text-slate-700">Seleccionar Sala:</label>
            <select id="room-selector" onchange="renderTimetable(this.value)" class="bg-slate-50 border border-slate-300 text-slate-700 text-sm rounded-lg p-2 w-64 outline-none focus:ring-2 focus:ring-blue-500">
                <option value="">-- Seleccione una Sala --</option>
            </select>
            <button onclick="openAssignModal()" class="bg-blue-600 hover:bg-blue-700 text-white text-sm px-4 py-2 rounded-lg shadow-sm transition flex items-center gap-2">
                <i data-lucide="plus-circle" class="w-4 h-4"></i> Añadir Asignatura
            </button>
        </div>
        <div class="text-sm text-slate-500">
            Haz clic en un bloque para ver detalles
        </div>
    </div>

    <div class="flex gap-6 relative overflow-hidden items-start">
        
        <div id="timetable-wrapper" class="bg-white rounded-xl shadow-sm border border-slate-100 overflow-x-auto p-4 transition-all duration-500 ease-in-out flex-1 w-full">
            <table class="w-auto text-sm border-collapse mx-auto">
                <thead>
                    <tr class="bg-slate-800 text-white text-center">
                        <th class="p-3 border border-slate-700 w-24">Módulo</th>
                        <th class="p-3 border border-slate-700 w-32">Lunes</th>
                        <th class="p-3 border border-slate-700 w-32">Martes</th>
                        <th class="p-3 border border-slate-700 w-32">Miércoles</th>
                        <th class="p-3 border border-slate-700 w-32">Jueves</th>
                        <th class="p-3 border border-slate-700 w-32">Viernes</th>
                        <th class="p-3 border border-slate-700 w-32">Sábado</th>
                    </tr>
                </thead>
                <tbody id="timetable-grid">
                    <script>
                        const times = [
                            "08:00 - 09:20", "09:30 - 10:50", "11:00 - 12:20", "12:30 - 13:50",
                            "14:00 - 15:20", "15:30 - 16:50", "17:00 - 18:20", "18:30 - 19:50"
                        ];
                        const days = ["lunes", "martes", "miercoles", "jueves", "viernes", "sabado"];
                        
                        for(let i=0; i<8; i++) {
                            document.write(`<tr class="border-b border-slate-200 hover:bg-slate-50 transition">`);
                            document.write(`
                                <td class="p-1 border-r border-slate-200 bg-slate-50 text-center w-24 h-14">
                                    <span class="block font-bold text-sm text-blue-900">Módulo ${i+1}</span>
                                    <span class="text-[10px] text-slate-500 whitespace-nowrap">${times[i]}</span>
                                </td>
                            `);
                            days.forEach(day => {
                                document.write(`<td id="cell-${day}-${i+1}" class="p-1 border-r border-slate-200 align-top h-14 relative w-32"></td>`);
                            });
                            document.write(`</tr>`);
                        }
                    </script>
                </tbody>
            </table>
        </div>

        <aside id="details-panel" class="w-0 opacity-0 bg-white rounded-xl shadow-xl border border-slate-200 overflow-hidden transition-all duration-500 ease-in-out transform translate-x-full h-fit sticky top-0">
            <div class="w-80 p-6"> <div class="flex justify-between items-start mb-6 border-b border-slate-100 pb-4">
                    <h3 class="font-bold text-xl text-slate-800">Detalle Asignatura</h3>
                    <button onclick="closeDetailsPanel()" class="text-slate-400 hover:text-red-500 transition p-1 hover:bg-red-50 rounded">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                </div>

                <div class="space-y-4 text-sm" id="details-content">
                    </div>
            </div>
        </aside>

    </div>
</section>

<!-- Modal Añadir Asignatura -->
<div id="modal-assign-subject" class="fixed inset-0 bg-slate-900/50 hidden items-center justify-center z-50 backdrop-blur-sm transition-opacity">
    <div class="bg-white rounded-xl shadow-2xl w-full max-w-md p-6 transform transition-all scale-100">
        <div class="flex justify-between items-center mb-6">
            <h3 class="text-lg font-bold text-slate-800">Asignar Asignatura</h3>
            <button onclick="closeAssignModal()" class="text-slate-400 hover:text-slate-600 transition">
                <i data-lucide="x" class="w-5 h-5"></i>
            </button>
        </div>
        
        <div class="space-y-4">
            <div>
                <label class="block text-sm font-medium text-slate-700 mb-1">NRC</label>
                <input type="text" id="assign-nrc" class="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" placeholder="Ej: 12345">
            </div>
            <div>
                <label class="block text-sm font-medium text-slate-700 mb-1">Sección</label>
                <input type="text" id="assign-section" class="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" placeholder="Ej: 1">
            </div>
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">Día</label>
                    <select id="assign-day" class="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none">
                        <option value="lunes">Lunes</option>
                        <option value="martes">Martes</option>
                        <option value="miercoles">Miércoles</option>
                        <option value="jueves">Jueves</option>
                        <option value="viernes">Viernes</option>
                        <option value="sabado">Sábado</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">Módulo</label>
                    <select id="assign-module" class="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none">
                        <option value="1">1 (08:00)</option>
                        <option value="2">2 (09:30)</option>
                        <option value="3">3 (11:00)</option>
                        <option value="4">4 (12:30)</option>
                        <option value="5">5 (14:00)</option>
                        <option value="6">6 (15:30)</option>
                        <option value="7">7 (17:00)</option>
                        <option value="8">8 (18:30)</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="flex justify-end gap-3 mt-8">
            <button onclick="closeAssignModal()" class="px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg transition font-medium">Cancelar</button>
            <button onclick="submitAssignment()" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg shadow-sm transition font-medium">Guardar</button>
        </div>
    </div>
</div>

<!-- Modal Confirmar Eliminación -->
<div id="modal-delete-block" class="fixed inset-0 bg-slate-900/50 hidden items-center justify-center z-50 backdrop-blur-sm transition-opacity">
    <div class="bg-white rounded-xl shadow-2xl w-full max-w-sm p-6 transform transition-all scale-100 text-center">
        <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4 text-red-600">
            <i data-lucide="alert-triangle" class="w-6 h-6"></i>
        </div>
        <h3 class="text-lg font-bold text-slate-800 mb-2">¿Eliminar este bloque?</h3>
        <p class="text-sm text-slate-500 mb-6">Esta acción eliminará la asignatura de este horario. Esta acción no se puede deshacer.</p>
        
        <div class="flex justify-center gap-3">
            <button onclick="closeBlockDeleteModal()" class="px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg transition font-medium">Cancelar</button>
            <button onclick="confirmRoomBlockDelete()" class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg shadow-sm transition font-medium">Eliminar</button>
        </div>
    </div>
</div>